---
title: Operating System -Chapter 5
commentable: false
date: 2023-02-17
modified: true
Edit: 2023-02-17
mathjax: true
mermaid: true
tags: Operating-System notes
categories: study notes
description: 操作系统学习笔记：设备管理
status: Writing
---

# I/O控制方式

## 程序控制I/O

- 完成一次读写：
    - CPU向控制器发出命令
    - 读入I/O状态，不断循环直到I/O完成
    - 将I/O中的数据读入CPU寄存器
    - 将CPU寄存器写入主存中

<img src="https://raw.githubusercontent.com/adoptedirelia/adoptedirelia.github.io/main/_posts/2023-02-16-OS/pic8.png" width="70%"> 

- CPU干预频率：很频繁，在等待I/O完成过程中需要不断轮询检查

- 数据传送的单位：Byte

- 数据流向：
    - 读：I/O设备->CPU->内存
    - 写：内存->CPU->I/O设备

- 优劣：
    - 优点：实现简单，可以用软件的方式实现
    - 缺点：CPU和I/O串行工作，CPU利用率低，需要长期“忙等”

## 中断驱动方式

- 完成一次读写：
    - CPU向控制器发出命令
    - 读入I/O状态，阻塞该进程，直到I/O完成发出中断信号
    - 将I/O中的数据读入CPU寄存器
    - 将CPU寄存器写入主存中

<img src="https://raw.githubusercontent.com/adoptedirelia/adoptedirelia.github.io/main/_posts/2023-02-16-OS/pic9.png" width="70%"> 

- CPU干预频率：在I/O开始之前和完成之后需要CPU介入，等待I/O的时候可运行别的进程

- 数据传送单位：Byte

- 数据流向：
    - 读：I/O设备->CPU->内存
    - 写：内存->CPU->I/O设备

- 优劣:
    - 优点：解决了程序直接控制的最大的缺点，CPU不需要不停轮询，CPU利用率得到明显提升
    - 缺点：频繁的中断处理会消耗较多的CPU时间

## DMA方式

- 完成一次读写:
    - CPU给DMA发出命令，给出相应参数，然后CPU做自己的事情
    - DMA读完/写完数据给CPU发出中断信号

- CPU干预频率：传送一个或者多个数据块的开始或者结束的时候，CPU才进行干预

- 数据传送单位：一个/多个块

- 数据流向：
    - 读：I/O->内存
    - 写：内存->I/O

- 优劣：
    - 优点：CPU介入频率下降，数据传输增多
    - 缺点：只能读写连续的块，无法离散进行

## 通道控制方式

通道可以识别并且执行一系列通道命令，可以理解为小型CPU。

- 完成一次读写：
    - CPU向通道发出I/O指令，指明通道程序的位置以及需要操作的I/O设备，之后CPU切换到其他进程执行
    - 通道执行内存中的通道程序
    - 通道执行规定的任务后，向CPU发出中断信号


<img src="https://raw.githubusercontent.com/adoptedirelia/adoptedirelia.github.io/main/_posts/2023-02-16-OS/pic10.png" width="70%"> 


- CPU干预频率：极低，完成一组数据块的读写后才需要CPU干预

- 数据传送单位：一组数据块

- 数据流向：
    - 读：I/O->内存
    - 写：内存->I/O
- 优劣：
    - 优点：资源利用率高
    - 缺点：实现复杂


# 缓冲

## 作用

- 缓解CPU和I/O设备之间速度不匹配的矛盾
- 减少CPU的中断频率
- 解决数据粒度不匹配的问题
- 提高CPU和I/O设备之间的并行性

## 单缓冲

## 双缓冲

